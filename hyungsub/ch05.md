# ch05: 고급 SQL

## 요약
본 챕터는 SQL을 직접 사용하는 방법을 언어별로 서술하고, 프로시저, 트리거, 재귀, 피벗/롤업, 순위화, 원도우 등 SQL의 고급기능에 대해 설명한다. 최근에는 ORM의 사용으로 잘 사용되지는 않지만 여전히 가져갈 좋은 기능들이 있다.

## 프로그래밍 언어에서 SQL 접근
간단히 말해 프로그래밍 언어에서 sql 서버를 열고 db에 접근하여 CRUD를 하는 방법을 말한다. 책에선 java로 예시를 들지만 현재 Golang을 주 언어로 사용하는 관계로 간단한 golang sql 문법을 나열해보려고 한다.

"database/sql"
이 패키지를 사용해서 sql에 직접 접속한다.

// 데이터베이스 연결 설정
dsn := "user:password@tcp(127.0.0.1:3306)/mydatabase"
db, err := sql.Open("mysql", dsn)
if err != nil {
    log.Fatal(err)
}
defer db.Close()

// 데이터 조회 (SELECT)
rows, err := db.Query("SELECT id, name, age FROM users WHERE age > ?", 25)
if err != nil {
    log.Fatal(err)
}
defer rows.Close()

## SQL 함수 및 프로시저
sql을 동작하는 함수를 정의한다. 마지 일반 함수를 사용하는 것과 동일하다.
프로시저는 다양한 기능의 sql을 하나로 묶은 것을 말한다.

## 트리거
일반적인 트리거의 의미를 가진다. db에서 실행하면 특정 상황에 발생시 항상 실행된다.

## 재귀 질의
재귀 질의는 SQL에서 자기 자신을 참조하는 질의를 의미한다.

## 순위화
말 그대로 순위를 탐색할 때 유용하게 쓰일 수 있다. 오름(내림)차순 정렬 후 limit로 가져오는 방식 대신 더 효율적으로 사용할 수 있다.

## 윈도우, 피벗팅, 롤업, 큐브

피벗: 행-열 전환, 보고서 생성에 사용 
롤업: 계층별 총계, 드릴다운 분석에 사용 
큐브: 다차원 분석, 모든 조합의 총계 
윈도우 질의: 파티션 기반 분석, 순위, 추세, 비교 등 다양한 분석

이해가 어려운 부분은 AI를 활용하여 보완하였다. 다만 자주 사용하지는 않는다고 한다. ORM 내부에서 사용할 것이라고 예상된다.

## Q
1. 고급 SQL에서 나온 다양한 기능들 중 혹시 현업에서 사용한 예시가 있으실까요? 하나만 골라주셔도 좋고, 해당 기능을 사용해본 경험이 없으시다면 없다고 말씀해주셔도 좋습니다!

2. 순위화는 언제 사용하는 것이 좋을까요?